- category: Print Preview Tests
  tests:

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/4a4dffc2-b9be-4d51-b421-1270f726579e
      desc: |
        1. Load the report
        2. Click print preview
        3. Expected -> title information shows "relative" time filter, as well
            as the report table looks the same on both pages
        4. Expected -> The company logo should appear on top of the VAR logo in
            the upper right hand corner
      traits:
        - summary
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/4dfc02f0-36d3-4b63-b694-702eb9874e1e
      desc: |
        1. Load the report
        2. Click print preview
        3. Expected -> title information shows "range" time filter, as well
            as the report table looks the same on both pages
      traits:
        - summary
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/cf34688e-00a2-4338-8db9-21ea86045149
      desc: |
        1. Load the report
        2. Click print preview
        3. Expected -> title information shows "recent time window" time
            filter, as well as the report table looks the same on both pages
      traits:
        - summary
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/8d51f1e9-e263-405e-94ce-c89ef075261a
      desc: |
        1. Load the report
        2. Click print preview
        3. Expected -> title information shows the correct description of the
            "party name" filter set on the report
      traits:
        - summary
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/c4d24ef0-4900-4a22-b6c4-da8cb19b3823
      desc: |
        1. Load the report
        2. Click print preview
        3. Expected -> title information shows the correct description of the
            "party name by workgroup membership" filter set on the report
      traits:
        - summary
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/907a4d8d-1bdd-4faf-87f0-3959bbfce283
      desc: |
        1. Load the report
        2. Click print preview
        3. Expected -> title information shows the correct description of the
            "call minutes" (fact) filter set on the report
        4. Expected -> the report on the print preview page should load
            instantaneously because it was seeded by data from the report page
      traits:
        - detail
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/907a4d8d-1bdd-4faf-87f0-3959bbfce283
      desc: |
        1. Load the report
        2. Click print preview
        3. Expected -> title information shows the correct description of the
            "call minutes" (fact) filter set on the report
      traits:
        - detail
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx?_qa=20230427221131472541#report/3842/10912a53-8ab8-4ac6-a0c8-b8d08777ecfe
      desc: |
        1. Load the report
        2. Click print preview
        3. Expected -> title information shows the correct description of the
            "caller ID starts with" (detail dimension) filter set on the report
      traits:
        - detail
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx?_qa=20230427221131472541#report/3842/e90f0da4-2f0d-4adb-ad44-a956636d9157
      desc: |
        1. Load the report
        2. Click print preview
        3. Expected -> the OTFA report table should look the same on both pages
      traits:
        - detail
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/ff8b70b5-710c-4fc1-a2fe-a1f94515e0f0
      desc: |
        1. Load the report
        2. Click print preview
        3. On the print preview page, click on the green report cell
        4. Expected -> should load C2G
      traits:
        - detail
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/4dfc02f0-36d3-4b63-b694-702eb9874e1e
      desc: |
        1. Load the report
        2. Click print preview
        3. On the print preview page, click on one of the rows
        4. Expected -> should open a new tab with a detail report
      traits:
        - summary
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/c89ff976-602d-45dd-a3a6-5b2e2c890c54
      desc: |
        1. Load the report
        2. Click print preview
        3. Expected -> "sort by" and "only show" record count checkboxes should
            be checked
        4. Toggle both checkboxes to be unchecked
        5. Expected -> report should render normally
      traits:
        - detail
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/c89ff976-602d-45dd-a3a6-5b2e2c890c54
      desc: |
        1. Load the report
        2. Click print preview
        3. Once print preview loads, close the reports page
        4. Refresh the print preview page
        5. Expected -> print preview page should run a detail query, because it
            can't access the source page's data anymore
      traits:
        - detail
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/DashboardDetail.aspx?tabid=912b9658-acd4-4ead-8ec2-debb18b8fb81&chartid=graph4
      desc: |
        1. Load the dashboard detail
        2. Click print preview
        3. Expected -> everything look normal
      traits:
        - dashboard
        - mivc

- category: Exporting Report Table Tests
  tests:

    - link: https://webapp.brightmetrics.com/UI-2/pages/DashboardDetail.aspx?tabid=912b9658-acd4-4ead-8ec2-debb18b8fb81&chartid=graph4
      desc: |
        1. Load the dashboard detail
        2. Click "Save as Report"
        3. Expected -> report table to look the same on both the Dashboard
            Detail and Reports page
      traits:
        - dashboard
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/4dfc02f0-36d3-4b63-b694-702eb9874e1e
      desc: |
        1. Load the report
        2. Click on the cell that says "Jim Lewis"
        3. Load the detail report
        4. Expected -> there should be a filter for "Jim Lewis", and when
            hovering over it, it should say "This was added from drilling into a
            summary report cell"
        5. Expected -> detail should show as many records as were represented
            by the summary report aggregation
      traits:
        - summary
        - detail
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/4dfc02f0-36d3-4b63-b694-702eb9874e1e
      desc: |
        1. Load the report
        2. Click print preview
        3. Click on the cell that says "Jim Lewis"
        4. Load the detail report
        5. Expected -> detail report looks normal
      traits:
        - summary
        - detail
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/c4d24ef0-4900-4a22-b6c4-da8cb19b3823
      desc: |
        1. Load the report
        2. Click export
        3. Select PDF
        4. Select Portrait
        5. Change the title of the export to "TEST"
        6. Click EXPORT
        7. Once the export finishes, open the file (don't close the Export
            browser tab)
        8. Expected -> filename should be titled "TEST.pdf"
        9. Expected -> file should look the same as the report, and be rendered
            as a PDF in portrait orientation
        10. In the Export browser tab, click the link that says "click here to
            download manually"
        11. Expected -> Another file should download
      traits:
        - summary
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/c4d24ef0-4900-4a22-b6c4-da8cb19b3823
      desc: |
        1. Load the report
        2. Click export
        3. Expected -> the selections should be saved from last time (PDF /
            Portrait)
        4. Select PDF, then select Landscape, then click EXPORT
        5. Once the export finishes, open the file
        6. Expected -> file should look the same as the report, and be rendered
            as a PDF in landscape orientation
      traits:
        - summary
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/c4d24ef0-4900-4a22-b6c4-da8cb19b3823
      desc: |
        1. Load the report
        2. Click export, then select CSV, then select Formatted, then click EXPORT
        3. Once the export finishes, open the file
        4. Expected -> file should look the same as the report, and be rendered
            as CSV, with times formatted XX:XX:XX and percentages rendered with the
            percent sign (%)
      traits:
        - summary
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/c4d24ef0-4900-4a22-b6c4-da8cb19b3823
      desc: |
        1. Load the report
        2. Click export, then select CSV, then select Unformatted, then click EXPORT
        3. Once the export finishes, open the file
        4. Expected -> file should look the same as the report, and be rendered
            as CSV, with all values rendered as decimals
      traits:
        - summary
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/c4d24ef0-4900-4a22-b6c4-da8cb19b3823
      desc: |
        1. Load the report
        2. Click export, then select Excel, then click EXPORT
        3. Once the export finishes, open the file
        4. Expected -> file should look the same as the report, and be rendered
            as XLSX
      traits:
        - summary
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/Reports.aspx#report/3842/c4d24ef0-4900-4a22-b6c4-da8cb19b3823
      desc: |
        1. Load the report
        2. Click print preview
        3. Once the report loads, click "Export to: Excel"
        4. Expected -> export dialog should appear with "Excel" auto-selected. Now close that dialog
        6. Click "Export to: CSV"
        7. Expected -> export dialog should appear with "CSV" auto-selected. Now close that dialog
        8. Click "Export to: PDF"
        9. Expected -> export dialog should appear with "PDF" auto-selected
        10. Click EXPORT
        11. Once the export finishes, open the file
        12. Expected -> file should look the same as the report, and be rendered
            as PDF
      traits:
        - summary
        - mivc

    - link: https://webapp.brightmetrics.com/UI-2/pages/DashboardDetail.aspx?tabid=912b9658-acd4-4ead-8ec2-debb18b8fb81&chartid=graph4
      desc: |
        1. Load the dashboard detail page
        2. Once the page loads, click the "Export" button
        3. Once the dialog opens, select "Export Report" (it should be the
            default selection), then select CSV as the format, then select
            Unformatted as the format style
        4. Click EXPORT
        5. Once the export finishes, open the file
        6. Expected -> file should look the same as the report, and be rendered
            as XLSX
      traits:
        - dashboard
        - mivc

# TODO
# - Add genesys reports to Print Preview Tests
# - Add XData tests
